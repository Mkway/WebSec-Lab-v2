<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSec-Lab v2 - í†µí•© ëŒ€ì‹œë³´ë“œ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="../assets/css/dashboard.css" rel="stylesheet">
</head>
<body>
    <div id="app">
        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <i class="fas fa-shield-alt"></i> WebSec-Lab v2
                </a>
                <div class="navbar-nav ms-auto">
                    <span class="navbar-text">
                        <i class="fas fa-circle text-success"></i> {{ serverStatus }}
                    </span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="container-fluid mt-4">
            <div class="row">
                <!-- Sidebar -->
                <div class="col-md-3">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-bug"></i> ì·¨ì•½ì  í…ŒìŠ¤íŠ¸</h5>
                        </div>
                        <div class="card-body">
                            <div class="list-group">
                                <button
                                    v-for="vuln in vulnerabilities"
                                    :key="vuln.type"
                                    @click="selectVulnerability(vuln.type)"
                                    :class="['list-group-item', 'list-group-item-action', activeVuln === vuln.type ? 'active' : '']"
                                >
                                    <i :class="vuln.icon"></i> {{ vuln.name }}
                                    <span v-if="vuln.status === 'completed'" class="badge bg-success ms-2">ì™„ë£Œ</span>
                                    <span v-else-if="vuln.status === 'progress'" class="badge bg-warning ms-2">ì§„í–‰ì¤‘</span>
                                    <span v-else class="badge bg-secondary ms-2">ì˜ˆì •</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Panel -->
                <div class="col-md-9">
                    <!-- XSS Testing Panel -->
                    <div v-if="activeVuln === 'xss'">
                        <!-- Test Configuration Panel (ì‚¬ìš©ì ì¹œí™”ì ) -->
                        <div class="test-config-panel">
                            <h5>
                                <i class="fas fa-bug"></i>
                                XSS ë³´ì•ˆ í…ŒìŠ¤íŠ¸
                                <span class="info-tooltip">
                                    <i class="fas fa-question-circle"></i>
                                    <span class="tooltip-text">XSSëŠ” ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì›¹í˜ì´ì§€ì— ì‚½ì…í•˜ëŠ” ê³µê²©ì…ë‹ˆë‹¤</span>
                                </span>
                            </h5>
                            <div class="config-row">
                                <div>
                                    <label class="form-label">
                                        <i class="fas fa-code"></i> í…ŒìŠ¤íŠ¸í•  ì½”ë“œ
                                        <span class="info-tooltip">
                                            <i class="fas fa-info-circle"></i>
                                            <span class="tooltip-text">ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œë¥¼ ì…ë ¥í•˜ì—¬ ë³´ì•ˆ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤</span>
                                        </span>
                                    </label>
                                    <div class="input-group">
                                        <input
                                            v-model="xssPayload"
                                            type="text"
                                            class="form-control"
                                            placeholder="ì˜ˆ: &lt;script&gt;alert('XSS')&lt;/script&gt;"
                                        >
                                        <button @click="loadSamplePayload" class="btn btn-outline-secondary">
                                            <i class="fas fa-flask"></i> ìƒ˜í”Œ
                                        </button>
                                    </div>
                                </div>
                                <div>
                                    <label class="form-label">
                                        <i class="fas fa-theater-masks"></i> ìƒí™© ì„¤ì •
                                    </label>
                                    <select v-model="xssScenario" class="form-select">
                                        <option value="basic">ğŸ–¥ï¸ ê¸°ë³¸ ì›¹í˜ì´ì§€ ì¶œë ¥</option>
                                        <option value="search">ğŸ” ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€</option>
                                        <option value="greeting">ğŸ‘‹ ì‚¬ìš©ì ì¸ì‚¬ë§</option>
                                        <option value="form">ğŸ“ í¼ ì…ë ¥ ê²°ê³¼</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="form-label">
                                        <i class="fas fa-balance-scale"></i> ë¹„êµ ëª¨ë“œ
                                    </label>
                                    <select v-model="xssMode" class="form-select">
                                        <option value="both">âš”ï¸ ì·¨ì•½ vs ì•ˆì „ ë¹„êµ</option>
                                        <option value="vulnerable">ğŸ”“ ì·¨ì•½í•œ ì½”ë“œë§Œ</option>
                                        <option value="safe">ğŸ›¡ï¸ ì•ˆì „í•œ ì½”ë“œë§Œ</option>
                                    </select>
                                </div>
                                <div>
                                    <button @click="executeXSSTest" :disabled="isLoading" class="btn btn-danger btn-lg">
                                        <i class="fas fa-play" v-if="!isLoading"></i>
                                        <i class="fas fa-spinner fa-spin" v-else></i>
                                        {{ isLoading ? 'í…ŒìŠ¤íŠ¸ ì¤‘...' : 'ğŸš€ í…ŒìŠ¤íŠ¸ ì‹œì‘' }}
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Indicator -->
                        <div v-if="testProgress.show" class="test-progress">
                            <h6><i class="fas fa-clock"></i> í…ŒìŠ¤íŠ¸ ì§„í–‰ ìƒí™©</h6>
                            <div class="progress-steps">
                                <div class="progress-step" :class="getStepClass('request')">
                                    <div class="step-icon" :class="getStepClass('request')">
                                        <i class="fas fa-paper-plane"></i>
                                    </div>
                                    <div class="step-label">ìš”ì²­ ì „ì†¡</div>
                                </div>
                                <div class="progress-step" :class="getStepClass('parse')">
                                    <div class="step-icon" :class="getStepClass('parse')">
                                        <i class="fas fa-cogs"></i>
                                    </div>
                                    <div class="step-label">ì½”ë“œ íŒŒì‹±</div>
                                </div>
                                <div class="progress-step" :class="getStepClass('execute')">
                                    <div class="step-icon" :class="getStepClass('execute')">
                                        <i class="fas fa-play-circle"></i>
                                    </div>
                                    <div class="step-label">ì½”ë“œ ì‹¤í–‰</div>
                                </div>
                                <div class="progress-step" :class="getStepClass('analyze')">
                                    <div class="step-icon" :class="getStepClass('analyze')">
                                        <i class="fas fa-search"></i>
                                    </div>
                                    <div class="step-label">ë³´ì•ˆ ë¶„ì„</div>
                                </div>
                                <div class="progress-step" :class="getStepClass('result')">
                                    <div class="step-icon" :class="getStepClass('result')">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="step-label">ê²°ê³¼ ìƒì„±</div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Payloads Panel -->
                        <div class="card bg-light mb-4">
                            <div class="card-body">
                                <h6><i class="fas fa-bolt"></i> ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì„ íƒ</h6>
                                <div class="row">
                                    <div class="col-md-2" v-for="payload in quickPayloads" :key="payload.name">
                                        <button
                                            @click="selectQuickPayload(payload)"
                                            class="btn btn-sm btn-outline-primary w-100 mb-2"
                                            :title="payload.description"
                                        >
                                            {{ payload.icon }} {{ payload.name }}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Split View Results (ì‚¬ìš©ì ì¹œí™”ì  ë””ìì¸) -->
                        <div v-if="xssResult">
                            <!-- Success/Error Alert -->
                            <div v-if="xssResult.success" class="alert alert-success mb-4">
                                <i class="fas fa-check-circle"></i>
                                <strong>ğŸ‰ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!</strong>
                                ë³´ì•ˆ í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.
                            </div>
                            <div v-else-if="xssResult && !xssResult.success" class="alert alert-danger mb-4">
                                <i class="fas fa-exclamation-triangle"></i>
                                <strong>âŒ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜</strong><br>
                                {{ xssResult.error }}<br>
                                <small v-if="xssResult.details">ìƒì„¸ ì •ë³´: {{ xssResult.details }}</small>
                            </div>

                            <!-- Split View Comparison -->
                            <div v-if="xssMode === 'both' && xssResult.data" class="split-view-container">
                                <!-- Vulnerable Code Panel -->
                                <div class="vulnerable-panel">
                                    <div class="panel-header">
                                        <i class="fas fa-unlock"></i>
                                        <span>ğŸ”“ ì·¨ì•½í•œ ì½”ë“œ (ìœ„í—˜)</span>
                                        <span class="info-tooltip">
                                            <i class="fas fa-question-circle"></i>
                                            <span class="tooltip-text">ë³´ì•ˆ ì¡°ì¹˜ê°€ ì—†ì–´ XSS ê³µê²©ì— ì·¨ì•½í•œ ì½”ë“œì…ë‹ˆë‹¤</span>
                                        </span>
                                    </div>
                                    <div class="panel-body">
                                        <!-- Status Indicator -->
                                        <div class="status-indicator vulnerable">
                                            <i class="fas fa-exclamation-triangle"></i>
                                            {{ xssResult.data.result?.vulnerable?.xss_detected ? 'âš ï¸ XSS ê³µê²© ì„±ê³µ' : 'âœ… ê³µê²© ì‹¤íŒ¨' }}
                                        </div>

                                        <!-- PHP Source Code -->
                                        <div class="code-section">
                                            <h6><i class="fas fa-code"></i> PHP ì†ŒìŠ¤ ì½”ë“œ</h6>
                                            <div class="code-block vulnerable">
                                                echo $_GET['input'];<br>
                                                <span class="text-muted">// ì‚¬ìš©ì ì…ë ¥ì„ í•„í„°ë§ ì—†ì´ ê·¸ëŒ€ë¡œ ì¶œë ¥</span><br>
                                                <span class="text-danger">// âš ï¸ XSS ì·¨ì•½ì  ì¡´ì¬!</span>
                                            </div>
                                        </div>

                                        <!-- Execution Result -->
                                        <div class="result-section">
                                            <h6><i class="fas fa-desktop"></i> ì‹¤í–‰ ê²°ê³¼</h6>
                                            <div class="result-display" :class="xssResult.data.result?.vulnerable?.xss_detected ? 'has-xss' : 'no-xss'">
                                                <div v-if="xssResult.data.result?.vulnerable?.xss_detected" class="text-danger">
                                                    <strong>âš ï¸ ìœ„í—˜í•œ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë©ë‹ˆë‹¤!</strong>
                                                </div>
                                                <div class="mt-2">
                                                    <code>{{ xssResult.data.result?.vulnerable?.html_output }}</code>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Security Analysis -->
                                        <div class="security-analysis">
                                            <h6><i class="fas fa-shield-alt"></i> ë³´ì•ˆ ë¶„ì„</h6>
                                            <div class="analysis-item">
                                                <span>ìŠ¤í¬ë¦½íŠ¸ íƒœê·¸ íƒì§€</span>
                                                <span class="analysis-value bad">âŒ ì°¨ë‹¨ ì•ˆë¨</span>
                                            </div>
                                            <div class="analysis-item">
                                                <span>HTML ì¸ì½”ë”©</span>
                                                <span class="analysis-value bad">âŒ ì ìš© ì•ˆë¨</span>
                                            </div>
                                            <div class="analysis-item">
                                                <span>ë³´ì•ˆ ì ìˆ˜</span>
                                                <span class="analysis-value bad">0/100</span>
                                            </div>
                                            <div class="analysis-item">
                                                <span>ì‹¤í–‰ ì‹œê°„</span>
                                                <span class="analysis-value">{{ xssResult.data.result?.vulnerable?.execution_time }}ì´ˆ</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Safe Code Panel -->
                                <div class="safe-panel">
                                    <div class="panel-header">
                                        <i class="fas fa-lock"></i>
                                        <span>ğŸ›¡ï¸ ì•ˆì „í•œ ì½”ë“œ (ë³´í˜¸ë¨)</span>
                                        <span class="info-tooltip">
                                            <i class="fas fa-question-circle"></i>
                                            <span class="tooltip-text">ë³´ì•ˆ ì¡°ì¹˜ê°€ ì ìš©ë˜ì–´ XSS ê³µê²©ì„ ì°¨ë‹¨í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤</span>
                                        </span>
                                    </div>
                                    <div class="panel-body">
                                        <!-- Status Indicator -->
                                        <div class="status-indicator safe">
                                            <i class="fas fa-shield-alt"></i>
                                            {{ xssResult.data.result?.safe?.xss_detected ? 'âš ï¸ ë³´ì•ˆ ì‹¤íŒ¨' : 'âœ… XSS ì°¨ë‹¨ ì„±ê³µ' }}
                                        </div>

                                        <!-- PHP Source Code -->
                                        <div class="code-section">
                                            <h6><i class="fas fa-code"></i> PHP ì†ŒìŠ¤ ì½”ë“œ</h6>
                                            <div class="code-block safe">
                                                echo htmlspecialchars(<br>
                                                &nbsp;&nbsp;&nbsp;&nbsp;$_GET['input'],<br>
                                                &nbsp;&nbsp;&nbsp;&nbsp;ENT_QUOTES,<br>
                                                &nbsp;&nbsp;&nbsp;&nbsp;'UTF-8'<br>
                                                );<br>
                                                <span class="text-muted">// HTML ì—”í‹°í‹° ì¸ì½”ë”©ìœ¼ë¡œ XSS ì°¨ë‹¨</span><br>
                                                <span class="text-success">// âœ… ë³´ì•ˆ ì¡°ì¹˜ ì ìš©!</span>
                                            </div>
                                        </div>

                                        <!-- Execution Result -->
                                        <div class="result-section">
                                            <h6><i class="fas fa-desktop"></i> ì‹¤í–‰ ê²°ê³¼</h6>
                                            <div class="result-display no-xss">
                                                <div class="text-success">
                                                    <strong>âœ… ìŠ¤í¬ë¦½íŠ¸ê°€ ì•ˆì „í•˜ê²Œ ë¬´ë ¥í™”ë˜ì—ˆìŠµë‹ˆë‹¤!</strong>
                                                </div>
                                                <div class="mt-2">
                                                    <code>{{ xssResult.data.result?.safe?.raw_output || xssResult.data.result?.safe?.html_output }}</code>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Security Analysis -->
                                        <div class="security-analysis">
                                            <h6><i class="fas fa-shield-alt"></i> ë³´ì•ˆ ë¶„ì„</h6>
                                            <div class="analysis-item">
                                                <span>HTML ì¸ì½”ë”©</span>
                                                <span class="analysis-value good">âœ… ì ìš©ë¨</span>
                                            </div>
                                            <div class="analysis-item">
                                                <span>ìŠ¤í¬ë¦½íŠ¸ ë¬´ë ¥í™”</span>
                                                <span class="analysis-value good">âœ… ì„±ê³µ</span>
                                            </div>
                                            <div class="analysis-item">
                                                <span>ë³´ì•ˆ ì ìˆ˜</span>
                                                <span class="analysis-value good">95/100</span>
                                            </div>
                                            <div class="analysis-item">
                                                <span>ì‹¤í–‰ ì‹œê°„</span>
                                                <span class="analysis-value">{{ xssResult.data.result?.safe?.execution_time }}ì´ˆ</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                                <!-- Analysis -->
                                <div v-if="xssResult.data?.analysis" class="mt-3">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-microscope"></i> í˜ì´ë¡œë“œ ë¶„ì„ ê²°ê³¼</h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="row mb-3">
                                                <div class="col-md-3">
                                                    <strong>ìœ„í—˜ ìˆ˜ì¤€:</strong>
                                                    <span :class="getRiskClass(xssResult.data.analysis.risk_level)">
                                                        {{ xssResult.data.analysis.risk_level?.toUpperCase() }}
                                                    </span>
                                                </div>
                                                <div class="col-md-3">
                                                    <strong>í˜ì´ë¡œë“œ ê¸¸ì´:</strong>
                                                    {{ xssResult.data.analysis.payload_analysis?.length }}ì
                                                </div>
                                                <div class="col-md-3">
                                                    <strong>ìŠ¤í¬ë¦½íŠ¸ íƒœê·¸:</strong>
                                                    {{ xssResult.data.analysis.payload_analysis?.contains_script_tags ? 'í¬í•¨ë¨' : 'ì—†ìŒ' }}
                                                </div>
                                                <div class="col-md-3">
                                                    <strong>ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬:</strong>
                                                    {{ xssResult.data.analysis.payload_analysis?.contains_event_handlers }}ê°œ
                                                </div>
                                            </div>

                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <strong>ë¹„êµ ê²°ê³¼:</strong>
                                                    <ul class="mb-0">
                                                        <li>XSS ì°¨ë‹¨: {{ xssResult.data.result?.comparison?.xss_blocked ? 'âœ… ì„±ê³µ' : 'âŒ ì‹¤íŒ¨' }}</li>
                                                        <li>ì¶œë ¥ ì°¨ì´: {{ xssResult.data.result?.comparison?.output_different ? 'âœ… ìˆìŒ' : 'âŒ ì—†ìŒ' }}</li>
                                                        <li>ì·¨ì•½ì  ì™„í™”: {{ xssResult.data.result?.comparison?.vulnerability_mitigated ? 'âœ… ì™„ë£Œ' : 'âŒ ë¯¸ì™„ë£Œ' }}</li>
                                                    </ul>
                                                </div>
                                                <div class="col-md-6">
                                                    <strong>ë³´ì•ˆ ê¶Œì¥ì‚¬í•­:</strong>
                                                    <ul class="mb-0">
                                                        <li v-for="(rec, key) in xssResult.data.analysis.recommendations" :key="key">
                                                            {{ rec }}
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Live XSS Execution Demo -->
                                <div class="mt-4">
                                    <div class="card">
                                        <div class="card-header">
                                            <h6><i class="fas fa-play-circle"></i> ì‹¤ì‹œê°„ XSS ì‹¤í–‰ ë°ëª¨</h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <h6 class="text-danger">ì·¨ì•½í•œ í™˜ê²½</h6>
                                                    <div class="demo-frame-container">
                                                        <iframe
                                                            :src="getVulnerableDemoUrl()"
                                                            class="demo-iframe vulnerable-frame"
                                                            @load="onIframeLoad('vulnerable')"
                                                        ></iframe>
                                                        <div v-if="xssExecutionStatus.vulnerable" class="execution-status">
                                                            <i class="fas fa-exclamation-triangle text-danger"></i>
                                                            XSS ì‹¤í–‰ë¨!
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <h6 class="text-success">ì•ˆì „í•œ í™˜ê²½</h6>
                                                    <div class="demo-frame-container">
                                                        <iframe
                                                            :src="getSafeDemoUrl()"
                                                            class="demo-iframe safe-frame"
                                                            @load="onIframeLoad('safe')"
                                                        ></iframe>
                                                        <div v-if="xssExecutionStatus.safe === false" class="execution-status safe">
                                                            <i class="fas fa-shield-alt text-success"></i>
                                                            XSS ì°¨ë‹¨ë¨
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mt-3">
                                                <div class="alert alert-info">
                                                    <i class="fas fa-info-circle"></i>
                                                    <strong>ì‹¤ì‹œê°„ í…ŒìŠ¤íŠ¸:</strong> ìœ„ì˜ í”„ë ˆì„ì—ì„œ ì‹¤ì œ XSS ì½”ë“œê°€ ì‹¤í–‰ë©ë‹ˆë‹¤.
                                                    ì·¨ì•½í•œ í™˜ê²½ì—ì„œëŠ” alert()ì´ë‚˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ê³ , ì•ˆì „í•œ í™˜ê²½ì—ì„œëŠ” ì°¨ë‹¨ë©ë‹ˆë‹¤.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Other Vulnerability Panels -->
                    <div v-else class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-construction"></i> {{ getVulnName(activeVuln) }}</h5>
                        </div>
                        <div class="card-body text-center">
                            <i class="fas fa-tools fa-3x text-muted mb-3"></i>
                            <h5>êµ¬í˜„ ì˜ˆì •</h5>
                            <p class="text-muted">ì´ ì·¨ì•½ì  í…ŒìŠ¤íŠ¸ëŠ” í˜„ì¬ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.</p>
                            <small class="text-muted">Phase 2ì—ì„œ êµ¬í˜„ë  ì˜ˆì •ì…ë‹ˆë‹¤.</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-dark text-light text-center py-3 mt-5">
            <div class="container">
                <p class="mb-0">
                    <i class="fas fa-shield-alt"></i> WebSec-Lab v2 - ì•ˆì „í•œ í™˜ê²½ì—ì„œ ë°°ìš°ëŠ” ì›¹ ë³´ì•ˆ
                    <span class="ms-3">
                        <i class="fas fa-server"></i> PHP: {{ phpStatus }}
                    </span>
                </p>
            </div>
        </footer>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="../assets/js/dashboard.js"></script>
</body>
</html>