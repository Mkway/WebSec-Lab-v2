<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS ì „ìš© í…ŒìŠ¤íŠ¸ - WebSec-Lab v2</title>
    <script>
        // CSS ìºì‹± ë°©ì§€
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = `css/style.css?v=${Date.now()}`;
        document.head.appendChild(link);
    </script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>ğŸ”¥ XSS ì „ìš© í…ŒìŠ¤íŠ¸ í”Œë«í¼</h1>
            <p>Cross-Site Scripting ì·¨ì•½ì  ì‹¬í™” í•™ìŠµ ë° í…ŒìŠ¤íŠ¸</p>
            <a href="index.html" style="color: white; text-decoration: none; background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 20px; margin-top: 10px; display: inline-block;">â† ë©”ì¸ ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</a>
        </header>

        <!-- XSS ì´ë¡  ì„¹ì…˜ -->
        <div class="vulnerability-theory">
            <div class="theory-header">
                <span class="theory-icon">ğŸ”¥</span>
                <h2 class="theory-title">XSS ì·¨ì•½ì  ì™„ì „ ê°€ì´ë“œ</h2>
            </div>

            <div class="vulnerability-diagram">
                <h3>ğŸ¯ XSS ê³µê²© ìœ í˜•ë³„ ë¶„ë¥˜</h3>

                <div class="attack-vector">
                    <h4>1. ë°˜ì‚¬í˜• XSS (Reflected XSS)</h4>
                    <p>ì‚¬ìš©ì ì…ë ¥ì´ ì¦‰ì‹œ ì‘ë‹µì— ë°˜ì˜ë˜ëŠ” í˜•íƒœ</p>
                    <div class="attack-flow">
                        <div class="flow-step">ì•…ì„± ë§í¬ í´ë¦­</div>
                        <span class="flow-arrow">â¡ï¸</span>
                        <div class="flow-step">ì„œë²„ ì²˜ë¦¬</div>
                        <span class="flow-arrow">â¡ï¸</span>
                        <div class="flow-step">ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰</div>
                    </div>
                </div>

                <div class="attack-vector">
                    <h4>2. ì €ì¥í˜• XSS (Stored XSS)</h4>
                    <p>ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ì–´ ì§€ì†ì ìœ¼ë¡œ ì‹¤í–‰</p>
                    <div class="attack-flow">
                        <div class="flow-step">ê²Œì‹œë¬¼ ì‘ì„±</div>
                        <span class="flow-arrow">â¡ï¸</span>
                        <div class="flow-step">DB ì €ì¥</div>
                        <span class="flow-arrow">â¡ï¸</span>
                        <div class="flow-step">í˜ì´ì§€ ì¡°íšŒ</div>
                        <span class="flow-arrow">â¡ï¸</span>
                        <div class="flow-step">ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰</div>
                    </div>
                </div>

                <div class="attack-vector">
                    <h4>3. DOM ê¸°ë°˜ XSS (DOM-based XSS)</h4>
                    <p>í´ë¼ì´ì–¸íŠ¸ ì¸¡ JavaScriptì—ì„œ DOM ì¡°ì‘ì„ í†µí•´ ë°œìƒ</p>
                    <div class="attack-flow">
                        <div class="flow-step">URL ì¡°ì‘</div>
                        <span class="flow-arrow">â¡ï¸</span>
                        <div class="flow-step">JavaScript ì²˜ë¦¬</div>
                        <span class="flow-arrow">â¡ï¸</span>
                        <div class="flow-step">DOM ì¡°ì‘</div>
                        <span class="flow-arrow">â¡ï¸</span>
                        <div class="flow-step">ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- XSS í˜ì´ë¡œë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
        <div class="main-content" style="max-width: none;">
            <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); margin: 20px 0;">
                <h2>ğŸ¯ XSS í˜ì´ë¡œë“œ ë¼ì´ë¸ŒëŸ¬ë¦¬</h2>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                    <div class="attack-vector">
                        <h4>ê¸°ë³¸ ìŠ¤í¬ë¦½íŠ¸ íƒœê·¸</h4>
                        <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code>
                        <button onclick="testPayload('<script>alert(\\'XSS\\')</script>')">í…ŒìŠ¤íŠ¸</button>
                    </div>

                    <div class="attack-vector">
                        <h4>ì´ë¯¸ì§€ íƒœê·¸ ì˜¤ë¥˜</h4>
                        <code>&lt;img src=x onerror=alert('XSS')&gt;</code>
                        <button onclick="testPayload('<img src=x onerror=alert(\\'XSS\\')>')">í…ŒìŠ¤íŠ¸</button>
                    </div>

                    <div class="attack-vector">
                        <h4>SVG íƒœê·¸</h4>
                        <code>&lt;svg onload=alert('XSS')&gt;</code>
                        <button onclick="testPayload('<svg onload=alert(\\'XSS\\')>')">í…ŒìŠ¤íŠ¸</button>
                    </div>

                    <div class="attack-vector">
                        <h4>JavaScript í”„ë¡œí† ì½œ</h4>
                        <code>&lt;a href=javascript:alert('XSS')&gt;í´ë¦­&lt;/a&gt;</code>
                        <button onclick="testPayload('<a href=javascript:alert(\\'XSS\\')>í´ë¦­</a>')">í…ŒìŠ¤íŠ¸</button>
                    </div>

                    <div class="attack-vector">
                        <h4>ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬</h4>
                        <code>&lt;div onclick=alert('XSS')&gt;í´ë¦­í•˜ì„¸ìš”&lt;/div&gt;</code>
                        <button onclick="testPayload('<div onclick=alert(\\'XSS\\')>í´ë¦­í•˜ì„¸ìš”</div>')">í…ŒìŠ¤íŠ¸</button>
                    </div>

                    <div class="attack-vector">
                        <h4>ì¸ë¼ì¸ ìŠ¤íƒ€ì¼</h4>
                        <code>&lt;div style=width:expression(alert('XSS'))&gt;</code>
                        <button onclick="testPayload('<div style=width:expression(alert(\\'XSS\\'))>')">í…ŒìŠ¤íŠ¸</button>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <h3>ğŸ”¬ ì‹¤ì‹œê°„ XSS í…ŒìŠ¤íŠ¸</h3>
                    <div style="display: flex; gap: 15px; align-items: center; margin: 15px 0;">
                        <textarea id="custom-payload" placeholder="ì»¤ìŠ¤í…€ XSS í˜ì´ë¡œë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”" style="flex: 1; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: monospace;">&lt;script&gt;alert('Custom XSS')&lt;/script&gt;</textarea>
                        <button onclick="testCustomPayload()" style="padding: 12px 20px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer;">ì‹¤í–‰</button>
                    </div>

                    <div id="xss-result" style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #17a2b8; display: none;">
                        <strong>ì‹¤í–‰ ê²°ê³¼:</strong>
                        <div id="xss-output"></div>
                    </div>
                </div>

                <!-- ëª¨ë“  ì–¸ì–´ ë™ì‹œ í…ŒìŠ¤íŠ¸ -->
                <div style="margin-top: 30px;">
                    <button id="test-all-btn" onclick="testAllLanguages()" class="test-button" style="width: 100%;">
                        ğŸŒ ëª¨ë“  ì–¸ì–´ì—ì„œ XSS í…ŒìŠ¤íŠ¸ ì‹¤í–‰
                    </button>

                    <div id="loading" class="loading" style="display: none;">
                        <div class="spinner"></div>
                        ëª¨ë“  ì–¸ì–´ì—ì„œ XSS í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤...
                    </div>

                    <div id="results" class="results-section" style="display: none;">
                        <h3>ğŸ“Š XSS í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3>
                        <div id="results-content"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ë¸Œë¼ìš°ì € ìºì‹± ë°©ì§€ë¥¼ ìœ„í•œ ë™ì  ìŠ¤í¬ë¦½íŠ¸ ë¡œë”©
        const timestamp = Date.now();
        const scripts = [
            'js/vulnerability-renderer.js',
            'js/comparison-renderer.js',
            'js/app.js'
        ];

        scripts.forEach(src => {
            const script = document.createElement('script');
            script.src = `${src}?v=${timestamp}`;
            document.head.appendChild(script);
        });

        // í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        function testPayload(payload) {
            document.getElementById('custom-payload').value = payload;
            testCustomPayload();
        }

        // ì»¤ìŠ¤í…€ í˜ì´ë¡œë“œ í…ŒìŠ¤íŠ¸
        function testCustomPayload() {
            const payload = document.getElementById('custom-payload').value;
            const resultDiv = document.getElementById('xss-result');
            const outputDiv = document.getElementById('xss-output');

            resultDiv.style.display = 'block';
            outputDiv.innerHTML = '';

            try {
                // XSS ì‹¤í–‰ ì‹œë®¬ë ˆì´ì…˜
                outputDiv.innerHTML = `
                    <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ddd; margin: 10px 0;">
                        <strong>í˜ì´ë¡œë“œ:</strong> <code>${escapeHtml(payload)}</code>
                    </div>
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border: 1px solid #ffeaa7; margin: 10px 0;">
                        <strong>âš ï¸ ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰:</strong> ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰ë©ë‹ˆë‹¤:
                        <div style="margin-top: 10px; font-family: monospace; background: white; padding: 10px; border-radius: 4px;">
                            ${payload}
                        </div>
                    </div>
                `;

                // ì‹¤ì œ XSS ì‹¤í–‰ (ì•ˆì „í•œ í™˜ê²½ì—ì„œë§Œ)
                if (payload.includes('alert')) {
                    setTimeout(() => {
                        try {
                            if (payload.includes('<script>')) {
                                const scriptContent = payload.match(/<script[^>]*>(.*?)<\/script>/i)?.[1];
                                if (scriptContent) {
                                    eval(scriptContent);
                                }
                            } else if (payload.includes('onerror')) {
                                const onErrorContent = payload.match(/onerror\s*=\s*['"](.*?)['"]/i)?.[1];
                                if (onErrorContent) {
                                    eval(onErrorContent);
                                }
                            } else if (payload.includes('onload')) {
                                const onLoadContent = payload.match(/onload\s*=\s*['"](.*?)['"]/i)?.[1];
                                if (onLoadContent) {
                                    eval(onLoadContent);
                                }
                            }
                        } catch (error) {
                            console.log('XSS ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜:', error);
                        }
                    }, 500);
                }

            } catch (error) {
                outputDiv.innerHTML = `<div style="color: #dc3545;">ì˜¤ë¥˜: ${error.message}</div>`;
            }
        }

        // HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ëª¨ë“  ì–¸ì–´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (app.jsì—ì„œ ê°€ì ¸ì˜¨ í•¨ìˆ˜ ì‚¬ìš©)
        function testAllLanguages() {
            // XSS ì·¨ì•½ì ìœ¼ë¡œ ì„¤ì •
            currentVulnerability = 'xss';

            // ì»¤ìŠ¤í…€ í˜ì´ë¡œë“œ ì‚¬ìš©
            const payload = document.getElementById('custom-payload').value;
            if (!elements.xssPayload) {
                // elementsê°€ ì•„ì§ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì§ì ‘ ì„¤ì •
                setTimeout(() => {
                    const xssPayloadElement = document.createElement('input');
                    xssPayloadElement.value = payload;
                    elements = elements || {};
                    elements.xssPayload = xssPayloadElement;
                    elements.loading = document.getElementById('loading');
                    elements.results = document.getElementById('results');
                    elements.resultsContent = document.getElementById('results-content');

                    runTest();
                }, 100);
            } else {
                elements.xssPayload.value = payload;
                runTest();
            }
        }
    </script>
</body>
</html>